stages:
 - build

variables:
  DOCKER_BUILD_TAG: "stable"

build-and-push:
  stage: build
  tags:
   - docker
   - medium
  image: docker:$DOCKER_BUILD_TAG
  before_script:
   - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
   - docker info
  script:
   - docker build -t $CI_REGISTRY_IMAGE:latest .
   - docker push $CI_REGISTRY_IMAGE:latest
